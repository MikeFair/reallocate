{% extends 'theme/base.html' %}
{% load i18n %}

{% trans "This is the title" as the_title %}

{% block meta_description %}{{ the_title }}{% endblock %}

{% block extra_css %}
    <style>
    #opp-title {
        position: relative;
        height: 100%;
    }
    #opp-title button {
        margin-top: 20px;
    }
    #opp-title h1 {
        color: #fdfdfd;
        font-size: 38px;
        letter-spacing: 1px;
        font-weight: normal;
        margin-top: 0px;
    }
    #opp-title .row {
        width: 100%;
        position: absolute;
        bottom: 12px;
    }
    .opp-image {
        height: 161px;
    }
    .opp-description {
        font-size: 18px;
        border-bottom: 1px solid #ddd;
        padding-bottom: 10px;
        margin-bottom: 20px;
    }  
    .update {
        border-bottom: 1px solid #ededed;
        margin-bottom: 10px;
    }
    .update:last-child {
        border: none;
    }
    .update-username {
        color: black;
    }
    .update-opp-name {
        color: #808080;
    }
    .update-text {
        color: #808080;
    }
    .update-media img {
        width: 100%;
    }
    .jumbotron .overlay {
        height: 100%;
        width: 100%;
        background: -webkit-gradient(linear, 0 0, 0 100%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0.65)));
        background: -webkit-linear-gradient(rgba(0,0,0,0) 0%, rgba(0,0,0,0.65) 100%);
        background: -moz-linear-gradient(rgba(0,0,0,0) 0%, rgba(0,0,0,0.65) 100%);
        background: -o-linear-gradient(rgba(0,0,0,0) 0%, rgba(0,0,0,0.65) 100%);
        background: linear-gradient(rgba(0,0,0,0) 0%, rgba(0,0,0,0.65) 100%); /* FF3.6+ */ /* Chrome,Safari4+ */ /* Chrome10+,Safari5.1+ */ /* Opera 11.10+ */ /* IE10+ */ /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00000000', endColorstr='#a6000000',GradientType=0 ); /* IE6-9 */
    }
    .jumbotron {
        padding: 0px;
        background-image: url('{% if opportunity.media_url %}{{ opportunity.media_url }}{% else %}{{ project.media_url }}{% endif %}');
        background-size: cover;
        height: 270px;
    }
    .skill-icons {
        font-weight:bold;
        color:#f2736a;
        margin: 0 auto;
    }
    </style>
{% endblock %}

{% block breadcrumb %}
    <div class="container">
        <ul class="breadcrumb">
            <li><a href="/">Home</a></li>
            <li><a href="/project/{{ opportunity.project.id }}">{{ opportunity.project.name }}</a></li>
            <li class="active">{{ opportunity.name }}</li>
        </ul>
    </div>
{% endblock %}

{% block jumbotron %}
<div class="jumbotron">
    <div class="overlay">
        <div id="opp-title" class="container">
            <div class="row">
                <div class="col-10">
                    <h4>{{ project.name }}</h4>
                    <h1>{{ opportunity.name }}</h1> 
                </div>
                <div class="col-2">
                    <div class="skill-icons">
                    {% if opportunity.opp_type == 'skills' %}
                        <div class="give-icons"><i class="icon-fighter-jet icon-4x"></i><br/>Skills</div>
                    {% endif %}
                    
                    {% if opportunity.opp_type == 'knowledge' %}
                        <div class="give-icons"><i class="icon-book icon-4x"></i><br/>Knowledge</div>
                    {% endif %}
                
                    {% if opportunity.opp_type == 'equipment' %}
                        <div class="give-icons"><i class="icon-cogs icon-4x"></i><br/>Equipment</div>
                    {% endif %}
                
                    {% if opportunity.opp_type == 'money' %}
                        <div class="give-icons"><i class="icon-money icon-4x"></i><br/>Money</div>
                    {% endif %}
                    </div>
                    {% if not engaged or pending %}
                    <a href="#engage-modal" class="btn btn-block btn-primary" data-toggle="modal"{% if pending %} disabled=disabled {% endif %}>Engage</a>
                    {% include 'includes/engage_modal.html' %}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}

    <div class="container">

        <div class="row">
        
            <div class="col-8">

                <p class="opp-description">{{ opportunity.description|safe }}</p>

                <h4>Recent Updates</h4>
                <a name="updates"></a>
                {% if engaged %}{% include "includes/post-update.html" %}{% endif %}
      
                {% for update in updates %}
                <div class="update">
                    {% if update.media_url %}
                    <div class="update-media"><img src="{{ update.media_url }}"></div>
                    {% endif %}
                    <p class="update-date">{{ update.date_created.date }}</p>
                    <p class="update-text">{{ update.text|safe }}</p>
                    {% if update.created_by.get_profile.media_url %}                    
                    <img class="update-avatar" src="{{ update.created_by.get_profile.media_url }}" />
                    {% endif %}
                    <a class="update-username" href="/profile/{{ update.created_by.id }}">
                        {{ update.created_by.first_name }} {{ update.created_by.last_name }}
                    </a>
                </div>
                {% endfor %}

            </div>

            <div class="col-4">
                <div class="addthis-toolbox">
                    <a class="share addthis-button-twitter ">
                        <i class="icon-twitter icon-2x"></i>
                    </a>
                    <a class="share addthis-button-facebook ">
                        <i class="icon-facebook icon-2x"></i>
                    </a>
                    <a class="share addthis-button-linkedin ">
                        <i class="icon-linkedin-sign icon-2x"></i>
                    </a>
                </div>
                <h4>Deliverables</h4>
                <p class="opp-deliverables">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eu magna non felis venenatis adipiscing. Ut elementum bibendum nisi in accumsan. Curabitur imperdiet, lacus et mollis euismod, elit dui vestibulum nulla, eu bibendum leo metus condimentum nisl. Cras et diam a nunc pretium venenatis hendrerit vel metus. Quisque semper ornare tellus ut commodo.</p>

                <h4>Prerequisites</h4>
                <p class="opp-prereqs">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas eu magna non felis venenatis adipiscing. Ut elementum bibendum nisi in accumsan. Curabitur imperdiet, lacus et mollis euismod, elit dui vestibulum nulla, eu bibendum leo metus condimentum nisl. Cras et diam a nunc pretium venenatis hendrerit vel metus. Quisque semper ornare tellus ut commodo.</p>
                
                <h4>Resources</h4>
                <p class="opp-resources">http://Linkto3rdpartyresource.com</p>
            </div>
        </div>
    </div>
    
{% endblock %}

{% block bottomscript %}
<script>
    $(document).ready(function () {
        $('#target').submit(function() {
            alert('Handler for .submit() called.');
            return false;
        });     

        var twitter_share_msg = "Check out the work being done on {{ opportunity.name }} for {{ project.name }} at @reallocate. " + window.location.href;
        var title = "Check out Reallocate";
        var description = "Check out the work we're doing : {{ opportunity.name }}.";
        reAllocate.setupAddThis(twitter=twitter_share_msg, title=title, description=description);
    });
</script>

{% endblock %}
