{% extends 'theme/base.html' %}
{% load i18n %}

{% trans "This is the title" as the_title %}

{% block meta_description %}{{ the_title }}{% endblock %}


{% block extra_css %}
    <style>
        .oppContainer{
            margin-bottom: 20px;
            box-shadow: 1px 2px 3px #808080;
            -moz-box-shadow: 1px 2px 3px #808080;
            -webkit-box-shadow: 1px 2px 3px #808080;
        }
        
        .oppImage{
            height: 161px;
        }

        .oppText {
            background-color: rgba(0,0,0,.45);
            height: 161px;
            color: #ffffff;
            
        }
        .oppTitle{
            font-size: 20px;
            text-align: center;
        }
        
        .oppDescription{
            text-align: center;
        }
        
        .updateThumb{ }
        .updateUserName{
            color: black;
        }
        .updateOppName{
            color: #808080;
        }
        .updateText{
            color: #808080;
        }
        .updateMedia{
            margin:5px;
        }
        
        .project_top .project_media_url img {

            margin-bottom: 10px;
        }
        
        .project_top .stat-label {
            font-weight: 100;
        }
        .project_top .number {
            font-size: 2em;
            margin-bottom: 5px;
        }
        .update-row {
            /*border-right: solid 1px #b0b0b0;*/
        }
        
    </style>
{% endblock %}
{% block maincontent %}

    <div class="container">
        <ul class="breadcrumb">
            <li id="breadcrumb-menu-home"><a href="/">Home</a><span class="divider">/</span></li>
            <li id="breadcrumb-menu-mission"
                class="active">{{ project.name }}
            </li>
        </ul>
    </div>
    
    <div class="project_wrap container">
        <div class="row-fluid">
            <div class="span12">
                <div class="project_title push-little">
                    <h1 class="text-center">{{ project.name }}</h1>
                </div>
            </div>
        </div>
        
        <div class="row-fluid project_top">
            <div class="container-fluid">
                <div class="span8 project_media_url">
                    <img src="{{ project.media_url }}"/>
                    <br/>
                    
                    <div class="fb-like" data-href="http://www.jon.com" data-send="true" data-width="400" data-show-faces="false"></div>
                    
                    <div id="fb-root"></div>
                    <script>(function(d, s, id) {
                      var js, fjs = d.getElementsByTagName(s)[0];
                      if (d.getElementById(id)) return;
                      js = d.createElement(s); js.id = id;
                      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=151555328193390";
                      fjs.parentNode.insertBefore(js, fjs);
                    }(document, 'script', 'facebook-jssdk'));</script>
                    
                    <hr/>
                </div>
                
                
                <div class="span4">
                    
                    <div class="row-fluid" id="statistics">
                        <div class="stat span4">
                            <div id="num-following" class="text-center number">{{ num_following }}</div>
                            <div class="stat-label text-center">followers</div>
                        </div>
                        <div class="stat span4">
                            <div class="text-center number">0</div>
                            <div class="stat-label text-center">participants</div>
                        </div>
                        <div class="stat span4">
                            <div class="text-center number">{{ num_opportunities }}</div>
                            <div class="stat-label text-center">opportunities</div>
                        </div>
                    </div>
                    
                    <hr/>
                    
                    <div class="row-fluid">
                        <div class="span4">
                            <img src="{{ project.created_by.get_profile.media_url }}"/>
                        </div>
                        <div class="span8">
                            <i>Project By</i><br/>
                            <a class="username" href="/profile/{{ project.created_by.id }}">
                                {{ project.created_by.first_name }} {{ project.created_by.last_name }}
                            </a>
                            
                        </div>
                    </div>
                    
                    
                    
                    {% if logged_in %}
                        <div class='follow-or-not'>
                            <a href="#" class="btn btn-primary login-required unfollow-project" {% if not is_following %}style='display:none;'{% endif %}project-id="{{ project.id }}">Following</a>
                            <a href="#" class="btn login-required follow-project" {% if is_following %}style='display:none;'{% endif %} project-id="{{ project.id }}">Follow</a>
                        </div>
                    {% endif %}
                </div>
                <div class="row-fluid">
                    <div class="span8">
                        <div class="title">The Story</div>
                        <div class="vision">
                            {{ project.description|safe }}
                        </div>
                    </div>
                    <div class="span4">
                        {% for opp in opportunities%}
                        <div class="oppContainer">
                            <div class="oppImage" style="background-image: url('{{ opp.media_url }}'); background-size: 287px 161px; background-repeat: no-repeat;">
                            <div class="oppText">
                                <div class="oppTitle"> {{opp.name}} </div>
                                <div class="oppDescription"> {{opp.short_desc|safe|truncatewords:15}}</div>
                                <a href="/opportunity/{{opp.id}}">Get Involved</a>
                            </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        
        <div class="container-fluid project_lower_header">
            <div class="row-fluid">
                <div class="span7">
                    Updates
                </div>
                <div class="span5">
                    Opportunities
                </div>
            </div>
        </div>
        
        <div class="row-fluid project_lower">
            <div class="container-fluid">
                <div class="span7" id="updates">
                    {% for update in updates%}
                        <div class="row-fluid update-row">
                            <div class="span2">
                                <img class="updateThumb" src="{{update.created_by.get_profile.media_url}}"/>
                            </div>
                            <div class="span10">
                                <div class="updateUserName"> {{update.user.username}} </div>
                                <div class="updateOppName"> {{update.opportunity.name}} </div>
                                <div class="updateText">  {{update.text}}</div>
                                <div class="updateMedia"> <img width="100%" height="100%" src="{{ update.media_url }}"> </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
                <div class="span5 well" id="opportunity_list">
                    
                    <div class="container-fluid">
                        {% for opp in opportunities%}
                        <div class="row-fluid oppRow">
                            <div class="span2">
                                <img class="oppThumb" src="{{ opp.media_url }}"/>
                            </div>
                            <div class="span10">
                                <div class="oppTitle"> {{opp.name}} </div>
                                <div class="oppDescription"> {{opp.description|safe|truncatewords:15}}</div>
                                <a href="/opportunity/{{opp.id}}">Get Involved</a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div> 
        </div>
    </div>
    <!-- /container -->


{% endblock %}

{% block bottomscript %}
<script>
    $(document).ready(function(){
        $(".unfollow-project").click(function(){
            $(this).hide();
            $(".follow-project").show();
            num_following = parseInt($("#num-following").html());
            $("#num-following").html((num_following - 1).toString())
        });
        $(".follow-project").click(function(){
            $(this).hide();
            $(".unfollow-project").show();
            num_following = parseInt($("#num-following").html());
            $("#num-following").html((num_following + 1).toString())
        });
    });
</script>
{% endblock %}
